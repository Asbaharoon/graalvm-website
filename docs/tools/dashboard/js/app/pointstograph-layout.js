define((function(){var t=function(t,e){this._layoutContext=t,this._explorationDegrees=e};return t.layout=function(e,o){var n=new t(e,o);n.layoutNodes(),n.layoutLinks(),n.positionNodeLabels(),n.positionLinkLabels()},t.prototype.layoutNodes=function(){const t={},e=new Set,o=new Map,n=this._layoutContext.getNodeCount();for(let i=0;i<n;i++){let n=this._layoutContext.getNodeByIndex(i);const a=80*this._explorationDegrees[n.getId()];e.add(a),void 0===t[a]&&(t[a]=[]),t[a].push(n),o.set(n,{y:-a})}e.forEach(e=>{const n=t[e],i=e/80,a=n.length;for(let t=0;t<a;t++){let e=n[t],a=o.get(e);a.x=i%2*125+500*t,e.setPosition(a)}})},t.prototype.layoutLinks=function(){for(var t=0;t<this._layoutContext.getLinkCount();t++){var e=this._layoutContext.getLinkByIndex(t);e.setPoints(this.getEndpoints(e))}},t.prototype.getEndpoints=function(t){var e=this._layoutContext.getNodeById(t.getStartId()),o=this._layoutContext.getNodeById(t.getEndId()),n=e.getPosition(),i=o.getPosition(),a=e.getContentBounds(),s=o.getContentBounds(),y=n.x+a.x+.5*a.w,h=n.y+a.y+.5*a.h,r=i.x+s.x+.5*s.w,x=i.y+s.y+.5*s.h;a={x:n.x+a.x,y:n.y+a.y,w:a.w,h:a.h},s={x:i.x+s.x,y:i.y+s.y,w:s.w,h:s.h};var d=this._findLinkNodeIntersection(a,y,h,r,x,t.getStartConnectorOffset()),l=this._findLinkNodeIntersection(s,r,x,y,h,t.getEndConnectorOffset());return[d.x,d.y,l.x,l.y]},t.prototype._findLinkNodeIntersection=function(t,e,o,n,i,a){var s=Math.atan2(i-o,n-e),y=Math.atan2(t.h,t.w),h=Math.PI-y,r=-y,x=0,d=0;return s>=-h&&s<=r?(x=t.x+.5*t.w+Math.tan(Math.PI/2-s)*(.5*-t.h),d=t.y):s<=h&&s>=y?(x=t.x+.5*t.w+Math.tan(Math.PI/2-s)*(.5*t.h),d=t.y+t.h):s<=y&&s>=r?(x=t.x+t.w,d=t.y+.5*t.h+Math.tan(s)*(.5*t.w)):(x=t.x,d=t.y+.5*t.h+Math.tan(s)*(.5*-t.w)),a&&(x+=Math.cos(s)*a,d+=Math.sin(s)*a),{x:x,y:d}},t.prototype.positionNodeLabels=function(){for(var t=0;t<this._layoutContext.getNodeCount();t++){var e=this._layoutContext.getNodeByIndex(t);if(e.getLabelBounds()){var o=e.getContentBounds(),n=e.getPosition(),i=o.x+n.x+.5*o.w,a=o.y+n.y-o.h;e.setLabelPosition({x:i,y:a}),e.setLabelHalign("center")}}},t.prototype.positionLinkLabels=function(t){for(var e=0;e<this._layoutContext.getLinkCount();e++){var o=this._layoutContext.getLinkByIndex(e),n=o.getLabelBounds();if(n){var i=o.getPoints();if(i.length>=4){var a=i[0],s=i[i.length-2],y=i[1],h=a+.5*(s-a),r=y+.5*(i[i.length-1]-y-n.h);o.setLabelPosition({x:h,y:r}),o.setLabelHalign("center")}}}},t}));